# BioinnfAlgo

## HW1
Файл `main.py` содержит основную логику домашней работы:
1. **Процессинг файлов с последовательностями**: или `fasta`-файлов, или из `.txt`. В любом случае в последовательности остаются только нуклеотиды, указанные в конфигурационном файле (`hw1/config.yaml`). По умолчанию - **A**, **T**, **G**, **C**
2. **Генерация химерной последовательности** из процессированных последовательностей из п.1. Длина последовательности и средняя длина фрагмента указываются в конфигурационном файле. По умолчанию средняя длина фрагмента - 300 н., длина последовательности - 10 т.н.
3. **Построение HMM-модели** - определение матрицы эмиссий и переходов. 
    - Матрица переходов создается таким образом, что среднее число шагов в каждом из состояний равно средней длине фрагмента. 
    - Матрица эмиссий создается таким образом, что вероятность эмиссии для пиримидинов равна усредненной частоте пиримидинов в соответствующей последовательности. Аналогично для пуринов.
    - Изначальное стационарное состояние ищется как собственный вектор матрицы переходов, соответствующий собственному значению 1. При равномерном выборе последовательностей в генерации химерной последовательности, стационарное состояние также будет равномерным.
4. **Витерби-алгоритм**: поиск наиболее вероятного пути, с помощью которого была сгенерирована химерная последовательность. 

Выполнение кода через CLI:
```bash
python main.py --seq1 <path_to_seq1> --seq2 <path_to_seq2> --config <path_to_config>
```
- `--seq1` - указывается путь к первой последовательности, из фрагментов которой будет генерироваться химерная последовательность. Формат `fasta` или `txt`.
- `--seq2` - указывается путь ко второй последовательности, из фрагментов которой будет генерироваться химерная последовательность. Формат `fasta` или `txt`.
- `--config` - указываетя путь к конфигурационному файлу. Пример в данном репозитории находится по относительному пути `hw1/config.yaml`


**Пример конфигурационного файла:**

```yaml
GeneralParams:
  num_sequences: 2
  valid_nucleotides: ['A', 'T', 'G', 'C']

ChimeraGenerator:
  mean_fragment_length: 300
  max_seqlen: 10000
  seed: 42
  output_folder: 'data'
  output_name: 'chimera_seq'
  save_format: 'fasta'
```

